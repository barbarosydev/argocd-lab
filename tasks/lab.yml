version: '3'

tasks:
  up:
    desc: "ðŸ”¬ Start minikube and deploy ArgoCD"
    silent: true
    deps:
      - task: :_check-deps
    cmds:
      - ./scripts/minikube-start.sh --profile {{.PROFILE}} --k8s-version {{.K8S_VERSION}} --driver {{.MINIKUBE_DRIVER}}
      - ./scripts/argocd-deploy.sh --argocd-namespace {{.ARGOCD_NAMESPACE}} --argo-values {{.ARGO_VALUES}} --port {{.ARGOCD_PORT}}

  down:
    desc: "ðŸ”¬ Stop minikube (preserves data)"
    silent: true
    cmds:
      - ./scripts/minikube-stop.sh --profile {{.PROFILE}} --pause

  nuke:
    desc: "ðŸ”¬ Delete minikube and all data"
    silent: true
    cmds:
      - ./scripts/minikube-stop.sh --profile {{.PROFILE}}

  status:
    desc: "ðŸ”¬ Check lab status"
    silent: true
    cmds:
      - ./scripts/check-lab-status.sh
