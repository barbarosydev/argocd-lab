version: '3'

tasks:
  list:
    desc: "ðŸ“¦ List deployed applications"
    silent: true
    deps:
      - task: :_check-cluster
    cmds:
      - ./scripts/apps.sh list --namespace {{.ARGOCD_NAMESPACE}}

  sync:
    desc: "ðŸ“¦ Sync all ArgoCD applications"
    silent: true
    deps:
      - task: :_check-cluster
    cmds:
      - ./scripts/apps.sh sync --namespace {{.ARGOCD_NAMESPACE}}

  deploy:
    desc: "ðŸ“¦ Deploy an application"
    silent: true
    deps:
      - task: :_check-cluster
    cmds:
      - ./scripts/apps.sh deploy --app-name {{.APP_NAME | default "demo-api"}} --profile {{.PROFILE}} {{.CLI_ARGS}}

  undeploy:
    desc: "ðŸ“¦ Undeploy an application"
    silent: true
    deps:
      - task: :_check-cluster
    cmds:
      - ./scripts/apps.sh undeploy --app-name {{.APP_NAME | default "demo-api"}} --namespace {{.ARGOCD_NAMESPACE}} {{.CLI_ARGS}}
