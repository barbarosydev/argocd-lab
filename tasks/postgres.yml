version: '3'

tasks:
  deploy:
    desc: "ğŸ˜ Deploy PostgreSQL database"
    silent: true
    deps:
      - task: :_check-cluster
    cmds:
      - ./scripts/postgres.sh deploy

  deploy-gitops:
    desc: "ğŸ˜ Deploy PostgreSQL via ArgoCD (GitOps)"
    silent: true
    deps:
      - task: :_check-cluster
    cmds:
      - ./scripts/postgres.sh deploy --method gitops

  undeploy:
    desc: "ğŸ˜ Undeploy PostgreSQL database"
    silent: true
    deps:
      - task: :_check-cluster
    cmds:
      - ./scripts/postgres.sh undeploy

  status:
    desc: "ğŸ˜ Check PostgreSQL deployment status"
    silent: true
    deps:
      - task: :_check-cluster
    cmds:
      - ./scripts/postgres.sh status

  password:
    desc: "ğŸ˜ Show PostgreSQL credentials"
    silent: true
    deps:
      - task: :_check-cluster
    cmds:
      - ./scripts/postgres.sh password

  shell:
    desc: "ğŸ˜ Open psql shell to PostgreSQL"
    silent: true
    deps:
      - task: :_check-cluster
    cmds:
      - ./scripts/postgres.sh shell
